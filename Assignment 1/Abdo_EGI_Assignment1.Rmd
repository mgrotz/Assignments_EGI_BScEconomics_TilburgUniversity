---
title: "EGI Simulations"
author: "A.Nuur"
date: "2/16/2022"
output: html_document
---
packages
```{r}
library(ggplot2); library(tidyverse); library(readxl)
```
Parameters
```{r}
#Parameter
s<- 0.25
n <- 0.03
alpha <- 0.33
dep_rate <- 0.04
g <- 0.02

```
Initial values
```{r}
#Initial values
L0 <- 45.00
K0 <- 1075795.25
k0 <- K0/L0
A0 <- 10862.74
Y0 <- K0^(alpha) * (A0*L0)^(1-alpha)
year <- seq(2020, 2100, 1)
period <- 1:81 
```
Step1 calculate population and technology level
```{r}
#Population, L
L <- rep(NA, 81)
A <- rep(NA, 81)
L[1]<- L0
A[1]<- A0
for(i in 2:81){
  L[i]<- L[i-1]*exp(n)
  A[i]<- A[i-1]*exp(g)
}

A
```
Step2 calculate physical capital, physical cpaital per worker, then gdpPercap
```{r}
K <- rep(NA, 81)
k <- rep(NA, 81)
Y <- rep(NA, 81)
y<- rep(NA, 81)
y_growth <- rep(NA, 81)
K[1]<- K0
k[1]<- k0
Y[1]<- Y0
y[1]<- (Y0/L0)
y_growth[1 ]<- (y[2]- y[1]) / y[1]

for(i in 2:81){
  K[i]<- (1-dep_rate)*K[i-1] + s*Y[i-1]
  Y[i] <- K[i]^(alpha) * (A[i]*L[i])^(1-alpha)
  k[i] <- (K[i]/L[i])
  y[i] <- (Y[i])/ L[i]
  y_growth[i] <- (y[i] -y[i-1]) / y[i-1] 
}
plot.ts(y_growth)
#Period is fishy
k <- K/L

```
dataframe 
```{r}
sim_1 <- data.frame(Year= year, Period= period, tech= round(A,3), Labor= round(L,3),Kapital= round(K,3), small_k = round(k,39), GDP= round(Y,3),y_hat = round(y_growth,3))
```
######
A) Present a line chart of the growth rate of GDP per capita, computed in the previous step, as a function of time for the 2020-2100 period.
```{r}
ggplot()+ 
  geom_line(sim_1, mapping= aes(x= Year,y_hat ))+
 geom_hline(yintercept = 0.020, color= "red")+
  
  theme_bw()
```

B) Based on the figure, is GDP per capita in 2020 below or above its steady state level. Justify your answer by explicitly referring to how the growth rate GDP per capita evolves over time. Approximately, in which year does the economy reach the steady state?

Year 2082. I will prove it by labelling. 

#########3
#Simulation 2
##Part1: ex-post, with estimated A
It's a bern distribution
```{r}
library(Rlab)
#I need to cacluate the probability of each year, then calculate Expected tech level
#paramter of negative productivity shock

#w can only be achieved by simulation
w <- rbinom(length(2020:2100),1, prob= 0.05)
theta <- 0.05


```

Pop, A
```{r}
#Population, L
L_sim2 <- rep(NA, 81)
A_sim2 <- rep(NA, 81)
L_sim2[1]<- L0
A_sim2[1]<- A0
for(i in 2:81){
  L_sim2 [i]<- L_sim2[i-1]*exp(n)
  A_sim2[i]<- A_sim2[i-1]*exp(g)*(1-(w[i])*theta)
 }

```

The rest
```{r}
K_sim2 <- rep(NA, 81)
k_sim2 <- rep(NA, 81)
Y_sim2 <- rep(NA, 81)
y_sim2<- rep(NA, 81)
y_growth_sim2 <- rep(NA, 81)
K_sim2[1]<- K0
k_sim2[1]<- k0
Y_sim2[1]<- Y0
y_sim2[1]<- (Y0/L0)
y_growth_sim2[1 ]<- (y_sim2[2]- y_sim2[1]) / y_sim2[1]

for(i in 2:81){
  K_sim2[i]<- (1-dep_rate)*K_sim2[i-1] + s*Y_sim2[i-1]
  Y_sim2[i] <- K_sim2[i]^(alpha) * (A_sim2[i]*L_sim2[i])^(1-alpha)
  k_sim2[i] <- (K_sim2[i]/L_sim2[i])
  y_sim2[i] <- (Y_sim2[i])/ L_sim2[i]
  y_growth_sim2[i] <- (y_sim2[i] -y_sim2[i-1]) / y_sim2[i-1] 
}
test_sim2 <- data.frame(Year= year, Period= period, tech= A_sim2, Labor= L_sim2,Kapital= K_sim2, small_k = k_sim2, W=w, GDP= Y_sim2,gdpPercap= y_sim2, y_hat = y_growth_sim2)
```
c) I will add a
```{r}
ggplot()+
  geom_line(test_sim2, mapping= aes(Year,gdpPercap ))+
  
  geom_point()+
  theme_bw()
```

d)List the years for which there is an extreme weather event according to your simulation.
```{r}
test_sim2[which(test_sim2$y_hat <0), "Year"]

```
########3



