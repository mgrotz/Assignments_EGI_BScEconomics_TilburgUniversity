---
title: 'Economic Growth and Institutions: Assignment 1'
author: "Mathieu Van der Vel, Abdirahman Nuur and Maximilian Grotz"
date: "14 2 2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

```{r}
library(tidyverse)
```

# Introduction

```{r}
# Parameters
s = .25
delta = .04
alpha = .33
n = .03
g = .02

# y_sim1 in 2017 USD (PPP), K_sim1 in mill 2017 USD (PPP), A_sim1 in index
L_0 = 45.0
K_0 = 1075795.25
A_0 = 10862.74
```

# Simulation 1

```{r}
sim1 <- data.frame(year = 2020:2100,
                   L = L_0,
                   K_sim1 = K_0,
                   A_sim1 = A_0,
                   yhat_sim1 = NA,
                   Y_sim1 = K_0^alpha*(A_0*L_0)^(1-alpha),
                   y_sim1 = K_0^alpha*(A_0*L_0)^(1-alpha)/L_0)

# Start calculating values
sim1 <- sim1 %>%
  mutate(L = L_0*exp(n*(year-2020)))

for (i in 2:nrow(sim1)) {
  sim1$A_sim1[i] <- sim1$A_sim1[i-1]*exp(g)
  sim1$K_sim1[i] <- (1-delta)*sim1$K_sim1[i-1] + s*sim1$Y_sim1[i-1]
  sim1$Y_sim1[i] <- sim1$K_sim1[i]^alpha*(sim1$L[i]*sim1$A_sim1[i])^(1-alpha)
  sim1$y_sim1[i] <- sim1$Y_sim1[i]/sim1$L[i]
  sim1$yhat_sim1[i] <- (sim1$y_sim1[i]-sim1$y_sim1[i-1])/sim1$y_sim1[i-1]
}

ggplot(data = sim1, aes(x = year, y = yhat_sim1)) +
  geom_line()
```

# Simulation 2

𝜃 is an element (0,1)
now 𝐴(𝑡 + 1) = 𝐴(𝑡)𝑒𝑔[1 ― 𝑊(𝑡 + 1)𝜃].
First, we need to find the probability of the event happening. This probability is from a bernouli distribution.
```{r}
set.seed(420)
pi <- 0.05
theta <- 0.05
year <- c(2020:2100)
W <- as.integer(lapply(runif(length(year)), function(x) ifelse(x<pi, 1, 0)))


### Expected [E] ###

sim2_E <- data.frame(year = 2020:2100,
                   W = W,
                   L = L_0,
                   K_sim2 = K_0,
                   A_sim2 = A_0,
                   yhat_sim2 = NA, 
                   pi = pi)

sim2_E <- sim2_E %>%
  mutate(L = L_0*exp(n*(year-2020)))

sim2_E <- sim2_E %>%
  mutate(Y_sim2 = K_0^alpha*(A_sim2*L_0)^(1-alpha),
                   y_sim2 = K_0^alpha*(A_sim2*L_0)^(1-alpha)/L_0)

for (i in 2:nrow(sim2_E)) {
  sim2_E$A_sim2[i] <- sim2_E$A_sim2[i-1]*exp(g)*(1-sim2_E$pi[i]*theta)
  sim2_E$K_sim2[i] <- (1-delta)*sim2_E$K_sim2[i-1] + s*sim2_E$Y_sim2[i-1]
  sim2_E$Y_sim2[i] <- sim2_E$K_sim2[i]^alpha*(sim2_E$L[i]*sim2_E$A_sim2[i])^(1-alpha)
  sim2_E$y_sim2[i] <- sim2_E$Y_sim2[i]/sim2_E$L[i]
  sim2_E$yhat_sim2[i] <- (sim2_E$y_sim2[i]-sim2_E$y_sim2[i-1])/sim2_E$y_sim2[i-1]
}


### Random realisation [RR] ###

sim2_RR <- data.frame(year = 2020:2100,
                   W = W,
                   L = L_0,
                   K_sim2 = K_0,
                   A_sim2 = A_0,
                   yhat_sim2 = NA)

sim2_RR <- sim2_RR %>%
  mutate(L = L_0*exp(n*(year-2020)))

sim2_RR <- sim2_RR %>%
  mutate( Y_sim2 = K_0^alpha*(A_sim2*L_0)^(1-alpha),
                   y_sim2 = K_0^alpha*(A_sim2*L_0)^(1-alpha)/L_0)


for (i in 2:nrow(sim2_RR)) {
  sim2_RR$A_sim2[i] <- sim2_RR$A_sim2[i-1]*exp(g)*(1-sim2_RR$W[i]*theta)
  sim2_RR$K_sim2[i] <- (1-delta)*sim2_RR$K_sim2[i-1] + s*sim2_RR$Y_sim2[i-1]
  sim2_RR$Y_sim2[i] <- sim2_RR$K_sim2[i]^alpha*(sim2_RR$L[i]*sim2_RR$A_sim2[i])^(1-alpha)
  sim2_RR$y_sim2[i] <- sim2_RR$Y_sim2[i]/sim2_RR$L[i]
  sim2_RR$yhat_sim2[i] <- (sim2_RR$y_sim2[i]-sim2_RR$y_sim2[i-1])/sim2_RR$y_sim2[i-1]
}

```

# Simulation 3

```{r}

```

